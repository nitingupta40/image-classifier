{"ast":null,"code":"var _jsxFileName = \"/Users/thesavages/projects/image-classifier/src/App.js\";\nimport React, { useState, useRef, useReducer } from \"react\";\nimport \"./App.css\";\nconst machine = {\n  initial: \"initial\",\n  states: {\n    initial: {\n      on: {\n        next: \"loadingModel\"\n      }\n    },\n    loadingModel: {\n      on: {\n        next: \"modelReady\"\n      }\n    },\n    modelReady: {\n      on: {\n        next: \"imageReady\"\n      }\n    },\n    imageReady: {\n      on: {\n        next: \"identifying\"\n      },\n      showImage: true\n    },\n    identifying: {\n      on: {\n        next: \"complete\"\n      }\n    },\n    complete: {\n      on: {\n        next: \"modelReady\"\n      },\n      showImage: true,\n      showResults: true\n    }\n  }\n};\n\nfunction App() {\n  const [results, setResults] = useState([]);\n  const [imageURL, setImageURL] = useState(null);\n  const [model, setModel] = useState(null);\n  const imageRef = useRef();\n  const inputRef = useRef();\n\n  const reducer = (state, event) => machine.states[state].on[event] || machine.initial;\n\n  const [appState, dispatch] = useReducer(reducer, machine.initial);\n\n  const next = () => dispatch(\"next\");\n\n  const loadModel = async () => {\n    next();\n    const model = await mobilenet.load();\n    setModel(model);\n    next();\n  };\n\n  const identify = async () => {\n    next();\n    const results = await model.classify(imageRef.current);\n    setResults(results);\n    next();\n  };\n\n  const reset = async () => {\n    setResults([]);\n    next();\n  };\n\n  const upload = () => inputRef.current.click();\n\n  const handleUpload = event => {\n    const {\n      files\n    } = event.target;\n\n    if (files.length > 0) {\n      const url = URL.createObjectURL(event.target.files[0]);\n      setImageURL(url);\n      next();\n    }\n  };\n\n  const actionButton = {\n    initial: {\n      action: loadModel,\n      text: \"Load Model\"\n    },\n    loadingModel: {\n      text: \"Loading Model...\"\n    },\n    modelReady: {\n      action: upload,\n      text: \"Upload Image\"\n    },\n    imageReady: {\n      action: identify,\n      text: \"Identify Breed\"\n    },\n    identifying: {\n      text: \"Identifying...\"\n    },\n    complete: {\n      action: reset,\n      text: \"Reset\"\n    }\n  };\n  const {\n    showImage,\n    showResults\n  } = machine.states[appState];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, showImage && /*#__PURE__*/React.createElement(\"img\", {\n    src: imageURL,\n    alt: \"upload-preview\",\n    ref: imageRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    capture: \"camera\",\n    onChange: handleUpload,\n    ref: inputRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }), showResults && /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, results.map(({\n    className,\n    probability\n  }) => /*#__PURE__*/React.createElement(\"li\", {\n    key: className,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, `${className}: %${(probability * 100).toFixed(2)}`))), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: actionButton[appState].action || (() => {}),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, actionButton[appState].text));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/thesavages/projects/image-classifier/src/App.js"],"names":["React","useState","useRef","useReducer","machine","initial","states","on","next","loadingModel","modelReady","imageReady","showImage","identifying","complete","showResults","App","results","setResults","imageURL","setImageURL","model","setModel","imageRef","inputRef","reducer","state","event","appState","dispatch","loadModel","mobilenet","load","identify","classify","current","reset","upload","click","handleUpload","files","target","length","url","URL","createObjectURL","actionButton","action","text","map","className","probability","toFixed"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useReducer } from \"react\";\nimport \"./App.css\";\n\nconst machine = {\n  initial: \"initial\",\n  states: {\n    initial: { on: { next: \"loadingModel\" } },\n    loadingModel: { on: { next: \"modelReady\" } },\n    modelReady: { on: { next: \"imageReady\" } },\n    imageReady: { on: { next: \"identifying\" }, showImage: true },\n    identifying: { on: { next: \"complete\" } },\n    complete: { on: { next: \"modelReady\" }, showImage: true, showResults: true }\n  }\n};\n\nfunction App() {\n  const [results, setResults] = useState([]);\n  const [imageURL, setImageURL] = useState(null);\n  const [model, setModel] = useState(null);\n  const imageRef = useRef();\n  const inputRef = useRef();\n\n  const reducer = (state, event) =>\n    machine.states[state].on[event] || machine.initial;\n\n  const [appState, dispatch] = useReducer(reducer, machine.initial);\n  const next = () => dispatch(\"next\");\n\n  const loadModel = async () => {\n    next();\n    const model = await mobilenet.load();\n    setModel(model);\n    next();\n  };\n\n  const identify = async () => {\n    next();\n    const results = await model.classify(imageRef.current);\n    setResults(results);\n    next();\n  };\n\n  const reset = async () => {\n    setResults([]);\n    next();\n  };\n\n  const upload = () => inputRef.current.click();\n\n  const handleUpload = event => {\n    const { files } = event.target;\n    if (files.length > 0) {\n      const url = URL.createObjectURL(event.target.files[0]);\n      setImageURL(url);\n      next();\n    }\n  };\n\n  const actionButton = {\n    initial: { action: loadModel, text: \"Load Model\" },\n    loadingModel: { text: \"Loading Model...\" },\n    modelReady: { action: upload, text: \"Upload Image\" },\n    imageReady: { action: identify, text: \"Identify Breed\" },\n    identifying: { text: \"Identifying...\" },\n    complete: { action: reset, text: \"Reset\" }\n  };\n\n  const { showImage, showResults } = machine.states[appState];\n\n  return (\n    <div>\n      {showImage && <img src={imageURL} alt=\"upload-preview\" ref={imageRef} />}\n      <input\n        type=\"file\"\n        accept=\"image/*\"\n        capture=\"camera\"\n        onChange={handleUpload}\n        ref={inputRef}\n      />\n      {showResults && (\n        <ul>\n          {results.map(({ className, probability }) => (\n            <li key={className}>{`${className}: %${(probability * 100).toFixed(\n              2\n            )}`}</li>\n          ))}\n        </ul>\n      )}\n      <button onClick={actionButton[appState].action || (() => {})}>\n        {actionButton[appState].text}\n      </button>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}